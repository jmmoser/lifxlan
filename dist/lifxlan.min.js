var k=56700,e="255.255.255.255",i1="https://raw.githubusercontent.com/LIFX/products/master/products.json",x=new Uint8Array([0,0,0,0,0,0]),o1={UDP:1,RESERVED2:2,RESERVED3:3,RESERVED4:4,RESERVED5:5},t1={RIGHT:0,LEFT:1};var f1={SUCCESS:0,BUSY:1,INTERRUPTED_BY_RESET:2,INTERRUPTED_BY_HOMEKIT:3,INTERRUPTED_BY_LAN:4,INTERRUPTED_BY_CLOUD:5,NONE:255},s1={SAW:0,SINE:1,HALF_SINE:2,TRIANGLE:3,PULSE:4};var e1={NO_APPLY:0,APPLY:1,APPLY_ONLY:2},G0={OFF:0,MOVE:1,RESERVED1:2,RESERVED2:3},Z0={NO_APPLY:0,APPLY:1,APPLY_ONLY:2};var S0={OFF:0,RESERVED1:1,MORPH:2,FLAME:3,RESERVED2:4,SKY:5},W0={SUNRISE:0,SUNSET:1,CLOUDS:2};var F={GetService:2,StateService:3,GetHostFirmware:14,StateHostFirmware:15,GetWifiInfo:16,StateWifiInfo:17,GetWifiFirmware:18,StateWifiFirmware:19,GetPower:20,SetPower:21,StatePower:22,GetLabel:23,SetLabel:24,StateLabel:25,GetVersion:32,StateVersion:33,GetInfo:34,StateInfo:35,SetReboot:38,Acknowledgement:45,GetLocation:48,SetLocation:49,StateLocation:50,GetGroup:51,SetGroup:52,StateGroup:53,EchoRequest:58,EchoResponse:59,StateUnhandled:223,GetColor:101,SetColor:102,SetWaveform:103,LightState:107,GetLightPower:116,SetLightPower:117,StateLightPower:118,SetWaveformOptional:119,GetInfrared:120,StateInfrared:121,SetInfrared:122,GetHevCycle:142,SetHevCycle:143,StateHevCycle:144,GetHevCycleConfiguration:145,SetHevCycleConfiguration:146,StateHevCycleConfiguration:147,GetLastHevCycleResult:148,StateLastHevCycleResult:149,SetColorZones:501,GetColorZones:502,StateZone:503,StateMultiZone:506,GetMultiZoneEffect:507,SetMultiZoneEffect:508,StateMultiZoneEffect:509,SetExtendedColorZones:510,GetExtendedColorZones:511,StateExtendedColorZones:512,GetRPower:816,SetRPower:817,StateRPower:818,GetDeviceChain:701,StateDeviceChain:702,SetUserPosition:703,Get64:707,State64:711,Set64:715,GetTileEffect:718,SetTileEffect:719,StateTileEffect:720,SensorGetAmbientLight:401,SensorStateAmbientLight:402};function I(Z,G,S,W,J,V,P,Y){let K=36+(Y!=null?Y.byteLength:0),X=new Uint8Array(K),U=new DataView(X.buffer,X.byteOffset);if(U.setUint16(0,K,!0),U.setUint16(2,5120|+Z<<13|0,!0),U.setUint32(4,G,!0),X.set(S,8),U.setUint8(22,(W?1:0)<<0|(J?1:0)<<1),U.setUint8(23,V),U.setUint16(32,P,!0),Y)X.set(Y,36);return X}function u1(Z,G,S){let W=S.replace(/-/g,"");for(let J=0,V=0;J<W.length;J+=2,V++)Z[G+V]=parseInt(W.slice(J,J+2),16)}var J0=new TextEncoder;function G1(Z,G,S,W){if(J0.encodeInto(S,Z.subarray(G)),S.length<W)Z[G+S.length]=0}function Z1(Z,G){let S=new Uint8Array(G);return G1(S,0,Z,G),S}function z(Z,G,S){let W=Z.subarray(G.current,G.current+S);return G.current+=S,W}function Q0(Z,G){return Array.from(z(Z,G,16)).map((S)=>S.toString(16).padStart(2,"0")).join("")}var $0=new TextDecoder;function g(Z,G,S){let W=Z.subarray(G.current,G.current+S).findIndex((P)=>P===0),J=W>=0?W:S,V=$0.decode(Z.subarray(G.current,G.current+J));return G.current+=S,V}function v1(Z,G,S){Z.setBigUint64(G,BigInt(S.getTime())*1000000n,!0)}function M(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=new Date(Number(S.getBigUint64(G.current,!0)/1000000n));return G.current+=8,W}function S1(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint8(G.current);G.current+=1;let J=S.getUint32(G.current,!0);return G.current+=4,{service:W,port:J}}function W1(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=M(Z,G),J=z(Z,G,8),V=S.getUint16(G.current,!0);G.current+=2;let P=S.getUint16(G.current,!0);return G.current+=2,{build:W,reserved:J,version_minor:V,version_major:P}}function J1(Z,G){let W=new DataView(Z.buffer,Z.byteOffset).getFloat32(G.current,!0);G.current+=4;let J=z(Z,G,4),V=z(Z,G,4),P=z(Z,G,2);return{signal:W,reserved6:J,reserved7:V,reserved8:P}}function Q1(Z,G){let S=new DataView(Z.buffer,Z.byteOffset,Z.byteLength),W=M(Z,G),J=z(Z,G,8),V=S.getUint16(G.current,!0);G.current+=2;let P=S.getUint16(G.current,!0);return G.current+=2,{build:W,reserved6:J,version_minor:V,version_major:P}}function w(Z,G){let W=new DataView(Z.buffer,Z.byteOffset).getUint16(G.current,!0);return G.current+=2,W}function p(Z,G){return g(Z,G,32)}function $1(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint32(G.current,!0);G.current+=4;let J=S.getUint32(G.current,!0);return G.current+=4,{vendor:W,product:J}}function P1(Z,G){let S=M(Z,G),W=M(Z,G),J=M(Z,G);return{time:S,uptime:W,downtime:J}}function b(Z,G){let S=z(Z,G,16),W=g(Z,G,32),J=M(Z,G);return{location:S,label:W,updated_at:J}}function c(Z,G){let S=Q0(Z,G),W=g(Z,G,32),V=new DataView(Z.buffer,Z.byteOffset).getBigUint64(G.current,!0);return G.current+=8,{group:S,label:W,updated_at:V}}function V1(Z,G){return z(Z,G,64)}function l1(Z,G){let W=new DataView(Z.buffer,Z.byteOffset).getUint16(G.current,!0);return G.current+=2,W}function Y1(Z,G,S,W,J){let V=new Uint8Array(13),P=new DataView(V.buffer);return P.setUint16(1,Z,!0),P.setUint16(3,G,!0),P.setUint16(5,S,!0),P.setUint16(7,W,!0),P.setUint32(9,J,!0),V}function C1(Z){let G=new Uint8Array(2);return new DataView(G.buffer).setUint16(0,typeof Z==="number"?Z:Z?65535:0,!0),G}function F1(Z,G,S){let W=new Uint8Array(56),J=new DataView(W.buffer);if(typeof Z==="string")u1(W,0,Z);else W.set(Z,0);return G1(W,16,G,32),v1(J,48,S),W}function K1(Z,G,S){let W=new Uint8Array(56),J=new DataView(W.buffer);if(typeof Z==="string")u1(W,0,Z);else W.set(Z,0);return G1(W,16,G,32),v1(J,48,S),W}function X1(Z){let G=new Uint8Array(64);return G.set(Z),G}function U1(Z,G,S,W,J,V,P,Y,Q){let $=new Uint8Array(21),C=new DataView($.buffer);return $[1]=Z?1:0,C.setUint16(2,G,!0),C.setUint16(4,S,!0),C.setUint16(6,W,!0),C.setUint16(8,J,!0),C.setUint32(10,V,!0),C.setFloat32(14,P,!0),C.setInt16(18,Y,!0),C.setUint8(20,Q),$}function L1(Z,G){let S=new Uint8Array(6),W=new DataView(S.buffer),J=typeof Z==="number"?Z:Z?65535:0;return W.setUint16(0,J,!0),W.setUint32(2,G,!0),S}function z1(Z,G,S,W,J,V,P,Y,Q,$,C,K,X){let U=new Uint8Array(25),L=new DataView(U.buffer);return U[1]=Z?1:0,L.setUint16(2,G,!0),L.setUint16(4,S,!0),L.setUint16(6,W,!0),L.setUint16(8,J,!0),L.setUint32(10,V,!0),L.setFloat32(14,P,!0),L.setInt16(18,Y,!0),L.setUint8(20,Q),U[21]=$?1:0,U[22]=C?1:0,U[23]=K?1:0,U[24]=X?1:0,U}function D1(Z){let G=new Uint8Array(2);return new DataView(G.buffer).setUint16(0,Z,!0),G}function H1(Z,G){let S=new Uint8Array(5),W=new DataView(S.buffer);return W.setUint8(0,Z?1:0),W.setUint32(1,G,!0),S}function A1(Z,G){let S=new Uint8Array(5),W=new DataView(S.buffer);return W.setUint8(0,Z?1:0),W.setUint32(1,G,!0),S}function q1(Z){let G=new Uint8Array(1);return new DataView(G.buffer).setUint8(0,Z),G}function E1(Z,G){let S=new Uint8Array(3),W=new DataView(S.buffer);return W.setUint8(0,Z),W.setUint16(1,G,!0),S}function O1(Z,G,S,W,J){let V=new Uint8Array(6),P=new DataView(V.buffer);return P.setUint8(0,Z),P.setUint8(1,G),P.setUint8(2,0),P.setUint8(3,S),P.setUint8(4,W),P.setUint8(5,J),V}function B1(Z,G){let S=new Uint8Array(2),W=new DataView(S.buffer);return W.setUint8(0,Z),W.setUint8(1,G),S}function M1(Z,G,S,W,J,V,P,Y){let Q=new Uint8Array(15),$=new DataView(Q.buffer);return $.setUint8(0,Z),$.setUint8(1,G),$.setUint16(2,S,!0),$.setUint16(4,W,!0),$.setUint16(6,J,!0),$.setUint16(8,V,!0),$.setUint32(10,P,!0),$.setUint8(14,Y),Q}function I1(Z,G,S,W,J){let V=new Uint8Array(59),P=new DataView(V.buffer);return P.setUint32(0,Z,!0),P.setUint8(4,G),P.setUint8(5,0),P.setUint8(6,0),P.setUint32(7,S,!0),P.setBigUint64(11,W,!0),P.setUint32(19,0),P.setUint32(23,0),V.set(J.slice(0,32),27),V}function j1(Z,G,S,W,J){let V=new Uint8Array(664),P=new DataView(V.buffer);P.setUint32(0,Z,!0),P.setUint8(4,G),P.setUint16(5,S,!0),P.setUint8(7,W);for(let Y=0;Y<82;Y++){let Q=J[Y]||{hue:0,saturation:0,brightness:0,kelvin:0},$=8+Y*8;P.setUint16($,Q.hue,!0),P.setUint16($+2,Q.saturation,!0),P.setUint16($+4,Q.brightness,!0),P.setUint16($+6,Q.kelvin,!0)}return V}function _1(Z,G,S){let W=new Uint8Array(11),J=new DataView(W.buffer);return J.setUint8(0,Z),J.setUint8(1,0),J.setUint8(2,0),J.setFloat32(3,G,!0),J.setFloat32(7,S,!0),W}function N1(Z,G,S,W,J,V,P){let Y=new Uint8Array(522),Q=new DataView(Y.buffer);Q.setUint8(0,Z),Q.setUint8(1,G),Q.setUint8(2,0),Q.setUint8(3,S),Q.setUint8(4,W),Q.setUint8(5,J),Q.setUint32(6,V,!0);for(let $=0;$<64;$++){let C=P[$]||{hue:0,saturation:0,brightness:0,kelvin:0},K=10+$*8;Q.setUint16(K,C.hue,!0),Q.setUint16(K+2,C.saturation,!0),Q.setUint16(K+4,C.brightness,!0),Q.setUint16(K+6,C.kelvin,!0)}return Y}function k1(){let Z=new Uint8Array(2);return Z[0]=0,Z[1]=0,Z}function x1(Z,G,S,W,J,V,P,Y){let Q=new Uint8Array(188),$=new DataView(Q.buffer);$.setUint8(0,0),$.setUint8(1,0),$.setUint32(2,Z,!0),$.setUint8(6,G),$.setUint32(7,S,!0),$.setBigUint64(11,W,!0),$.setUint32(19,0),$.setUint32(23,0),$.setUint8(27,J),$.setUint8(28,0),$.setUint8(29,0),$.setUint8(30,0),$.setUint8(31,V),$.setUint32(32,0),$.setUint32(35,0),$.setUint32(51,0),$.setUint32(55,0),$.setUint8(59,P);for(let C=0;C<16;C++){let K=Y[C]||{hue:0,saturation:0,brightness:0,kelvin:0},X=60+C*8;$.setUint16(X,K.hue,!0),$.setUint16(X+2,K.saturation,!0),$.setUint16(X+4,K.brightness,!0),$.setUint16(X+6,K.kelvin,!0)}return Q}function T(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint16(G.current,!0);G.current+=2;let J=S.getUint16(G.current,!0);G.current+=2;let V=S.getUint16(G.current,!0);G.current+=2;let P=S.getUint16(G.current,!0);G.current+=2;let Y=z(Z,G,2),Q=S.getUint16(G.current,!0);G.current+=2;let $=g(Z,G,32),C=z(Z,G,8);return{hue:W,saturation:J,brightness:V,kelvin:P,power:Q,label:$,reserved2:Y,reserved8:C}}function h(Z,G){let W=new DataView(Z.buffer,Z.byteOffset).getUint16(G.current,!0);return G.current+=2,W}function u(Z,G){let W=new DataView(Z.buffer,Z.byteOffset).getUint16(G.current,!0);return G.current+=2,W}function v(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint32(G.current,!0);G.current+=4;let J=S.getUint32(G.current,!0);G.current+=4;let V=!!S.getUint8(G.current);return G.current+=1,{duration_s:W,remaining_s:J,last_power:V}}function l(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint8(G.current);G.current+=1;let J=S.getUint32(G.current,!0);return G.current+=4,{indication:W,duration_s:J}}function T1(Z,G){let S=Z[G.current];return G.current+=1,S}function y(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint8(G.current);G.current+=1;let J=S.getUint16(G.current,!0);return G.current+=2,{relay_index:W,level:J}}function h1(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint8(G.current);G.current+=1;let J=[];for(let P=0;P<16;P++){let Y=S.getInt16(G.current,!0);G.current+=2;let Q=S.getInt16(G.current,!0);G.current+=2;let $=S.getInt16(G.current,!0);G.current+=2;let C=z(Z,G,2),K=S.getFloat32(G.current,!0);G.current+=4;let X=S.getFloat32(G.current,!0);G.current+=4;let U=S.getUint8(G.current);G.current+=1;let L=S.getUint8(G.current);G.current+=1;let D=z(Z,G,1),H=S.getUint32(G.current,!0);G.current+=4;let A=S.getUint32(G.current,!0);G.current+=4;let q=z(Z,G,4),E=M(Z,G),N=z(Z,G,8),f=S.getUint16(G.current,!0);G.current+=2;let s=S.getUint16(G.current,!0);G.current+=2;let r1=z(Z,G,4);J.push({accel_meas_x:Y,accel_meas_y:Q,accel_meas_z:$,reserved6:C,user_x:K,user_y:X,width:U,height:L,reserved7:D,device_version_vendor:H,device_version_product:A,reserved8:q,firmware_build:E,reserved9:N,firmware_version_minor:f,firmware_version_major:s,reserved10:r1})}let V=S.getUint8(G.current);return G.current+=1,{start_index:W,devices:J,tile_devices_count:V}}function m1(Z,G){let S=Z[G.current];G.current+=1;let W=z(Z,G,1),J=Z[G.current];G.current+=1;let V=Z[G.current];G.current+=1;let P=Z[G.current];G.current+=1;let Y=new DataView(Z.buffer,Z.byteOffset),Q=[];for(let $=0;$<64;$++){let C=Y.getUint16(G.current,!0);G.current+=2;let K=Y.getUint16(G.current,!0);G.current+=2;let X=Y.getUint16(G.current,!0);G.current+=2;let U=Y.getUint16(G.current,!0);G.current+=2,Q.push({hue:C,saturation:K,brightness:X,kelvin:U})}return{tile_index:S,reserved6:W,x:J,y:V,width:P,colors:Q}}function R(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint8(G.current);G.current+=1;let J=S.getUint8(G.current);G.current+=1;let V=[];for(let P=0;P<8;P++){let Y=S.getUint16(G.current,!0);G.current+=2;let Q=S.getUint16(G.current,!0);G.current+=2;let $=S.getUint16(G.current,!0);G.current+=2;let C=S.getUint16(G.current,!0);G.current+=2,V.push({hue:Y,saturation:Q,brightness:$,kelvin:C})}return{zones_count:W,zone_index:J,colors:V}}function d(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint32(G.current,!0);G.current+=4;let J=S.getUint8(G.current);G.current+=1;let V=z(Z,G,2),P=S.getUint32(G.current,!0);G.current+=4;let Y=S.getBigUint64(G.current,!0);G.current+=8;let Q=z(Z,G,4),$=z(Z,G,4),C=z(Z,G,32);return{instanceid:W,type:J,reserved6:V,speed:P,duration:Y,reserved7:Q,reserved8:$,parameters:C}}function n(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint16(G.current,!0);G.current+=2;let J=S.getUint16(G.current,!0);G.current+=2;let V=S.getUint8(G.current);G.current+=1;let P=[];for(let Y=0;Y<82;Y++){let Q=S.getUint16(G.current,!0);G.current+=2;let $=S.getUint16(G.current,!0);G.current+=2;let C=S.getUint16(G.current,!0);G.current+=2;let K=S.getUint16(G.current,!0);G.current+=2,P.push({hue:Q,saturation:$,brightness:C,kelvin:K})}return{zones_count:W,zone_index:J,colors_count:V,colors:P}}function a(Z,G){let S=new DataView(Z.buffer,Z.byteOffset),W=S.getUint8(G.current);G.current+=1;let J=S.getUint32(G.current,!0);G.current+=4;let V=S.getUint8(G.current);G.current+=1;let P=S.getUint32(G.current,!0);G.current+=4;let Y=S.getBigUint64(G.current,!0);G.current+=8;let Q=z(Z,G,4),$=z(Z,G,4),C=S.getUint8(G.current);G.current+=1;let K=z(Z,G,3),X=S.getUint8(G.current);G.current+=1;let U=z(Z,G,3),L=S.getUint8(G.current);G.current+=1;let D=z(Z,G,23),H=S.getUint8(G.current);G.current+=1;let A=[];for(let q=0;q<16;q++){let E=S.getUint16(G.current,!0);G.current+=2;let N=S.getUint16(G.current,!0);G.current+=2;let f=S.getUint16(G.current,!0);G.current+=2;let s=S.getUint16(G.current,!0);G.current+=2,A.push({hue:E,saturation:N,brightness:f,kelvin:s})}return{reserved0:W,instanceid:J,type:V,speed:P,duration:Y,reserved1:Q,reserved2:$,skyType:C,reserved3:K,cloudSaturationMin:X,reserved4:U,cloudSaturationMax:L,reserved5:D,palette_count:H,palette:A}}function g1(Z,G){let W=new DataView(Z.buffer,Z.byteOffset).getFloat32(G.current,!0);return G.current+=4,{lux:W}}var P0=(Z,G=0)=>Z.getUint16(G,!0),V0=(Z,G=0)=>Z.getUint16(G+2,!0);var Y0=(Z,G=0)=>Z.getUint32(G+4,!0),C0=(Z,G=0)=>Z.subarray(G+8,G+14),F0=(Z,G=0)=>Z.getUint8(G+22),K0=(Z)=>(Z&1)>0,X0=(Z)=>(Z&2)>0,U0=(Z,G=0)=>Z.getUint16(G+32,!0),L0=(Z,G=0)=>Z.getUint8(G+23),y1=(Z,G=0)=>Z.subarray(G+36);function w1(Z,G=0){let S=new DataView(Z.buffer,Z.byteOffset),W=P0(S,G),J=V0(S,G),V=J&4095,P=!!(J>>12&1),Y=!!(J>>13&1),Q=J>>14&3,$=Y0(S,G),C=C0(Z,G),K=Z.subarray(G+14,G+16),X=Z.subarray(G+16,G+22),U=F0(S,G),L=K0(U),D=X0(U),H=(U&252)>>2,A=L0(S,G),q=Z.subarray(G+24,G+32),E=U0(S,G),N=Z.subarray(G+34,G+36);return{bytes:Z.subarray(0,36),size:W,protocol:V,addressable:P,tagged:Y,origin:Q,source:$,target:C,reserved1:K,reserved2:X,res_required:L,ack_required:D,reserved3:H,reserved4:q,sequence:A,reserved5:N,type:E}}var O=(Z)=>{};function m(){let Z=O,G=O,S=new Promise((W,J)=>{Z=W,G=J});return{resolve:Z,reject:G,promise:S}}function z0(Z){if(Z===200)return"none";if(Z<-80||Z===4||Z===5||Z===6)return"very bad";if(Z<-70||Z>=7&&Z<=11)return"somewhat bad";if(Z<-60||Z>=12&&Z<=16)return"alright";if(Z<0||Z>16)return"good";return"none"}function D0(Z){return Math.floor(10*Math.log10(Z)+0.5)}function p1(Z){let G="",{length:S}=Z;for(let W=0;W<S;W++){let J=Z[W].toString(16);if(J.length<2)G+="0"+J;else G+=J}return G}function b1(Z){if(Z.length!==12)throw new Error("Invalid serial number");let G=new Uint8Array(6);for(let S=0;S<6;S++){let W=2*S;G[S]=parseInt(Z.slice(W,W+2),16)}return G}function H0(Z,G,S){Z=Z*6/65535,G=G/65535,S=S*255/65535;let W=Math.floor(Z),J=Z-W,V=S*(1-G),P=S*(1-G*J),Y=S*(1-G*(1-J)),Q,$,C;switch(W){case 0:Q=S,$=Y,C=V;break;case 1:Q=P,$=S,C=V;break;case 2:Q=V,$=S,C=Y;break;case 3:Q=V,$=P,C=S;break;case 4:Q=Y,$=V,C=S;break;default:Q=S,$=V,C=P}return[Math.round(Q),Math.round($),Math.round(C)]}function A0(Z,G,S){Z/=255,G/=255,S/=255;let W=Math.max(Z,G,S),J=W-Math.min(Z,G,S),V=J===0?0:J&&W===Z?(G-S)/J:W===G?2+(S-Z)/J:4+(Z-G)/J;return[Math.round(60*(V<0?V+6:V)*182.04166666666666),Math.round(W&&J/W*65535),Math.round(W*65535)]}class B extends Error{constructor(Z,G={}){super(Z);if(this.name=this.constructor.name,this.context=G,Error.captureStackTrace)Error.captureStackTrace(this,this.constructor)}toJSON(){return{name:this.name,message:this.message,context:this.context,stack:this.stack}}}class r extends B{constructor(Z,G="operation"){super(`${G} timed out after ${Z}ms`);this.timeoutMs=Z,this.operation=G}}class i extends B{constructor(Z,G){super(`Device ${G||"unknown"} returned unhandled command type: ${Z}`);this.commandType=Z,this.deviceSerial=G}}class o extends B{constructor(Z,G){super(`Message routing conflict for key: ${Z}`);this.key=Z,this.source=G}}class t extends B{constructor(){super("No more source IDs available. Consider disposing unused clients.")}}class R1 extends B{constructor(Z){super(`Cannot use disposed client with source ${Z}`);this.source=Z}}class _ extends B{constructor(Z,G,S){super(`Invalid ${Z}: ${G}${S?` (${S})`:""}`);this.parameter=Z,this.value=G,this.reason=S}}var d1=4294967295,q0=d1-2;function E0(Z){let G=Z.handlers??new Map,S=2;return{nextSource(){let W=-1;for(let J=0;J<q0;J++){if(!G.has(S)){W=S;break}if(S=(S+1)%4294967296,S<=1)S=2}if(W===-1)throw new t;return W},register(W,J){if(W<=1||W>d1)throw new _("source",W,"must be between 2 and 4294967295");if(G.has(W))throw new _("source",W,"already registered");G.set(W,J)},deregister(W,J){if(G.get(W)!==J)throw new _("messageHandler",J,"does not match registered handler");G.delete(W)},send(W,J,V,P){Z.onSend(W,J,V,P)},receive(W){let J=w1(W),V=y1(W),P=p1(J.target),Y=G.get(J.source);if(Y)Y(J,V,P);if(Z.onMessage)Z.onMessage(J,V,P);return{header:J,payload:V,serialNumber:P}}}}function a1(Z,G){return`${Z}:${G}`}function c1(Z){return Z==null?0:(Z+1)%255}function n1(Z,G,S,W,J,V,P){let Y=a1(G,S);if(V.has(Y))throw new o(Y,S);let{resolve:Q,reject:$,promise:C}=m();function K(L){if(V.delete(Y),L instanceof Error)$(L);else $(new Error("Operation aborted"))}let X;if(P)P.addEventListener("abort",K,{once:!0});else if(J>0)X=setTimeout(()=>K(new r(J,"device response")),J);function U(){if(P)P.removeEventListener("abort",K);else clearTimeout(X);V.delete(Y)}return V.set(Y,(L,D,H)=>{if(L===F.Acknowledgement){if(Z)U(),Q(void 0);return}if(U(),L===F.StateUnhandled){let A=l1(D,H);$(new i(A,G));return}if(!Z&&W)Q(W(D,H))}),C}function O0(Z){let G=Z.source??Z.router.nextSource(),S=Z.defaultTimeoutMs??3000,{router:W}=Z,J=new Map,V=!1,P={get router(){return W},get source(){return G},dispose(){if(V)return;V=!0,W.deregister(G,P.onMessage)},broadcast(Y){let Q=I(!0,G,x,!1,!1,255,Y.type,Y.payload);W.send(Q,k,e)},unicast(Y,Q){let $=I(!1,G,Q.target,!1,!1,Q.sequence,Y.type,Y.payload);W.send($,Q.port,Q.address,Q.serialNumber),Q.sequence=c1(Q.sequence)},sendOnlyAcknowledgement(Y,Q,$){let C=I(!1,G,Q.target,!1,!0,Q.sequence,Y.type,Y.payload),K=n1(!0,Q.serialNumber,Q.sequence,void 0,S,J,$);return Q.sequence=c1(Q.sequence),W.send(C,Q.port,Q.address,Q.serialNumber),K},send(Y,Q,$){let C=I(!1,G,Q.target,!0,!1,Q.sequence,Y.type,Y.payload),K=n1(!1,Q.serialNumber,Q.sequence,Y.decode,S,J,$);return Q.sequence=c1(Q.sequence),W.send(C,Q.port,Q.address,Q.serialNumber),K},onMessage(Y,Q,$){if(Z.onMessage)Z.onMessage(Y,Q,$);let C=J.get(a1($,Y.sequence));if(C)C(Y.type,Q,{current:0})}};return W.register(G,P.onMessage),P}function B0(){return{type:F.GetService,decode:S1}}function M0(){return{type:F.GetHostFirmware,decode:W1}}function I0(){return{type:F.GetWifiInfo,decode:J1}}function j0(){return{type:F.GetWifiFirmware,decode:Q1}}function _0(){return{type:F.GetPower,decode:w}}function N0(Z){return{type:F.SetPower,payload:C1(Z),decode:w}}function k0(){return{type:F.GetLabel,decode:p}}function x0(Z){return{type:F.SetLabel,payload:Z1(Z,32),decode:p}}function T0(){return{type:F.GetVersion,decode:$1}}function h0(){return{type:F.GetInfo,decode:P1}}function m0(){return{type:F.SetReboot,decode:O}}function g0(){return{type:F.GetLocation,decode:b}}function w0(Z,G,S){return{type:F.SetLocation,payload:F1(Z,G,S),decode:b}}function p0(){return{type:F.GetGroup,decode:c}}function b0(Z,G,S){return{type:F.SetGroup,payload:K1(Z,G,S),decode:c}}function c0(Z){return{type:F.EchoRequest,payload:X1(Z),decode:V1}}function u0(){return{type:F.GetColor,decode:T}}function v0(Z,G,S,W,J){return{type:F.SetColor,payload:Y1(Z,G,S,W,J),decode:T}}function l0(Z,G,S,W,J,V,P,Y,Q){return{type:F.SetWaveform,payload:U1(Z,G,S,W,J,V,P,Y,Q),decode:T}}function y0(){return{type:F.GetLightPower,decode:h}}function R0(Z,G){return{type:F.SetLightPower,payload:L1(Z,G),decode:h}}function d0(Z,G,S,W,J,V,P,Y,Q,$,C,K,X){return{type:F.SetWaveformOptional,payload:z1(Z,G,S,W,J,V,P,Y,Q,$,C,K,X),decode:h}}function n0(){return{type:F.GetInfrared,decode:u}}function a0(Z){return{type:F.SetInfrared,payload:D1(Z),decode:u}}function r0(){return{type:F.GetHevCycle,decode:v}}function i0(Z,G){return{type:F.SetHevCycle,payload:H1(Z,G),decode:v}}function o0(){return{type:F.GetHevCycleConfiguration,decode:l}}function t0(Z,G){return{type:F.SetHevCycleConfiguration,payload:A1(Z,G),decode:l}}function f0(){return{type:F.GetLastHevCycleResult,decode:T1}}function s0(Z,G){return{type:F.GetColorZones,payload:B1(Z,G),decode:R}}function e0(Z,G,S,W,J,V,P,Y){return{type:F.SetColorZones,payload:M1(Z,G,S,W,J,V,P,Y),decode:R}}function G5(){return{type:F.GetMultiZoneEffect,decode:d}}function Z5(Z,G,S,W,J){return{type:F.SetMultiZoneEffect,payload:I1(Z,G,S,W,J),decode:d}}function S5(){return{type:F.GetExtendedColorZones,decode:n}}function W5(Z,G,S,W,J){return{type:F.SetExtendedColorZones,payload:j1(Z,G,S,W,J),decode:n}}function J5(){return{type:F.GetDeviceChain,decode:h1}}function Q5(Z,G,S,W,J){return{type:F.Get64,payload:O1(Z,G,S,W,J),decode:m1}}function $5(Z,G,S){return{type:F.SetUserPosition,payload:_1(Z,G,S),decode:O}}function P5(Z,G,S,W,J,V,P){return{type:F.Set64,payload:N1(Z,G,S,W,J,V,P),decode:O}}function V5(){return{type:F.GetTileEffect,payload:k1(),decode:a}}function Y5(Z,G,S,W,J,V,P,Y){return{type:F.SetTileEffect,payload:x1(Z,G,S,W,J,V,P,Y),decode:a}}function C5(Z){return{type:F.GetRPower,payload:q1(Z),decode:y}}function F5(Z,G){return{type:F.SetRPower,payload:E1(Z,G),decode:y}}function K5(){return{type:F.SensorGetAmbientLight,decode:g1}}function X5(Z){return Z.port??=k,Z.target??=Z.serialNumber?b1(Z.serialNumber):x,Z.sequence=0,Z}function U5(Z){let G=Z?.defaultTimeoutMs??3000,S=Z?.onAdded,W=Z?.onChanged,J=Z?.onRemoved,V=new Map,P=new Map;function Y(Q,$,C,K){let X=V.get(Q);if(X){if($!==X.port||C!==X.address){if(X.port=$,X.address=C,W)W(X)}return X}let U=X5({serialNumber:Q,port:$,address:C,target:K});if(V.set(Q,U),S)S(U);return U}return{get registered(){return V},register(Q,$,C,K){let X=Y(Q,$,C,K),U=P.get(Q);if(U)P.delete(Q),U.forEach((L)=>{L(X)});return X},remove(Q){let $=V.get(Q),C=V.delete(Q);if($&&J)J($);return C},get(Q,$){let C=V.get(Q);if(C)return Promise.resolve(C);let{resolve:K,reject:X,promise:U}=m();function L(q){let E=P.get(Q);if(E)if(E.size>1)E.delete(K);else P.delete(Q);X(q instanceof Error?q:new Error("Abort"))}let D;if($)$.addEventListener("abort",L,{once:!0});else D=setTimeout(()=>L(new Error("Timeout")),G);let H=(q)=>{if($)$.removeEventListener("abort",L);else clearTimeout(D);K(q)},A=P.get(Q);if(!A)P.set(Q,new Set([H]));else A.add(H);return U}}}function L5(Z){let G=Z?.onAdded,S=Z?.onChanged,W=Z?.onRemoved,J=new Map;function V(Y){let Q=J.get(Y);if(Q){if(J.delete(Y),W)W(Q)}}function P(Y,Q){for(let $=0;$<Y.devices.length;$+=1)if(Y.devices[$]===Q)return $;return-1}return{register(Y,Q){let $=J.get(Q.group);if($){if(P($,Y)<0){if($.devices.push(Y),S)S($)}}else{let C={label:Q.label,uuid:Q.group,devices:[Y]};if(J.set(Q.group,C),G)G(C)}},remove(Y){V(Y)},removeDevice(Y){J.forEach((Q)=>{let $=P(Q,Y);if($>=0){if(Q.devices[$]=Q.devices[Q.devices.length-1],Q.devices.pop(),Q.devices.length===0)V(Q.uuid);else if(S)S(Q)}})},get registered(){return J}}}export{A0 as rgbToHsb,H0 as hsbToRgb,z0 as getRssiStatus,Z1 as encodeString,z1 as encodeSetWaveformOptional,U1 as encodeSetWaveform,_1 as encodeSetUserPosition,x1 as encodeSetTileEffect,E1 as encodeSetRPower,C1 as encodeSetPower,I1 as encodeSetMultiZoneEffect,F1 as encodeSetLocation,L1 as encodeSetLightPower,D1 as encodeSetInfrared,A1 as encodeSetHevCycleConfiguration,H1 as encodeSetHevCycle,K1 as encodeSetGroup,j1 as encodeSetExtendedColorZones,M1 as encodeSetColorZones,Y1 as encodeSetColor,N1 as encodeSet64,k1 as encodeGetTileEffect,q1 as encodeGetRPower,B1 as encodeGetColorZones,O1 as encodeGet64,X1 as encodeEchoRequest,I as encode,J1 as decodeStateWifiInfo,Q1 as decodeStateWifiFirmware,$1 as decodeStateVersion,a as decodeStateTileEffect,S1 as decodeStateService,y as decodeStateRPower,w as decodeStatePower,d as decodeStateMultiZoneEffect,R as decodeStateMultiZone,b as decodeStateLocation,h as decodeStateLightPower,T1 as decodeStateLastHevCycleResult,p as decodeStateLabel,u as decodeStateInfrared,P1 as decodeStateInfo,W1 as decodeStateHostFirmware,l as decodeStateHevCycleConfiguration,v as decodeStateHevCycle,c as decodeStateGroup,n as decodeStateExtendedColorZones,h1 as decodeStateDeviceChain,m1 as decodeState64,g1 as decodeSensorStateAmbientLight,T as decodeLightState,w1 as decodeHeader,V1 as decodeEchoResponse,p1 as convertTargetToSerialNumber,D0 as convertSignalToRssi,b1 as convertSerialNumberToTarget,s1 as Waveform,_ as ValidationError,i as UnhandledCommandError,F as Type,r as TimeoutError,S0 as TileEffectType,W0 as TileEffectSkyType,t as SourceExhaustionError,d0 as SetWaveformOptionalCommand,l0 as SetWaveformCommand,$5 as SetUserPositionCommand,Y5 as SetTileEffectCommand,m0 as SetRebootCommand,F5 as SetRPowerCommand,N0 as SetPowerCommand,Z5 as SetMultiZoneEffectCommand,w0 as SetLocationCommand,R0 as SetLightPowerCommand,x0 as SetLabelCommand,a0 as SetInfraredCommand,t0 as SetHevCycleConfigurationCommand,i0 as SetHevCycleCommand,b0 as SetGroupCommand,W5 as SetExtendedColorZonesCommand,e0 as SetColorZonesCommand,v0 as SetColorCommand,P5 as Set64Command,o1 as ServiceType,K5 as SensorGetAmbientLightCommand,E0 as Router,m as PromiseWithResolvers,i1 as PRODUCTS_URL,k as PORT,x as NO_TARGET,O as NOOP,Z0 as MultiZoneExtendedApplicationRequest,G0 as MultiZoneEffectType,e1 as MultiZoneApplicationRequest,o as MessageConflictError,f1 as LightLastHevCycleResult,B as LifxError,L5 as Groups,I0 as GetWifiInfoCommand,j0 as GetWifiFirmwareCommand,T0 as GetVersionCommand,V5 as GetTileEffectCommand,B0 as GetServiceCommand,C5 as GetRPowerCommand,_0 as GetPowerCommand,G5 as GetMultiZoneEffectCommand,g0 as GetLocationCommand,y0 as GetLightPowerCommand,f0 as GetLastHevCycleResultCommand,k0 as GetLabelCommand,n0 as GetInfraredCommand,h0 as GetInfoCommand,M0 as GetHostFirmwareCommand,o0 as GetHevCycleConfigurationCommand,r0 as GetHevCycleCommand,p0 as GetGroupCommand,S5 as GetExtendedColorZonesCommand,J5 as GetDeviceChainCommand,s0 as GetColorZonesCommand,u0 as GetColorCommand,Q5 as Get64Command,c0 as EchoRequestCommand,R1 as DisposedClientError,t1 as Direction,U5 as Devices,O0 as Client,e as BROADCAST_ADDRESS};
